"use strict";(self.webpackChunksandbox=self.webpackChunksandbox||[]).push([[36],{9036:(lt,x,s)=>{s.r(x),s.d(x,{HeightFieldExampleComponent:()=>Z,HeightFieldExampleComponentModule:()=>ht});var d=s(3834),g=s(5667),y=s(221),u=s(4761),S=s(1507),B=s(3815),C=s(991),Q=s(9978),J=s(1546),f=s(4476),E=s(1307),F=s(5e3),t=s(6186),V=s(8919),z=s(7843),D=s(2310),H=s(2046);const I=["elementSize","","heights",""],T=["*"];let O=(()=>{class e extends u.DE{constructor(){super(...arguments),this.elementSize=0}set heights(n){this.set({heights:n})}ngOnInit(){super.ngOnInit(),this.zone.runOutsideAngular(()=>{this.onCanvasReady(this.store.ready$,()=>{this.effect((0,D.b)(()=>{if(!this.instanceValue)return;const n=this.get(a=>a.heights),o=this.elementSize,h=this.elementSize,p=n.flatMap((a,r)=>a.flatMap((m,l)=>[r*o,l*h,m])),c=[];for(let a=0;a<n.length-1;a++)for(let r=0;r<n[a].length-1;r++){const m=n[a].length,l=a*m+r;c.push(l+1,l+m,l+m+1),c.push(l+m,l+1,l)}this.instanceValue.setIndex(c),this.instanceValue.setAttribute("position",new H.a$l(p,3)),this.instanceValue.computeVertexNormals(),this.instanceValue.computeBoundingBox(),this.instanceValue.computeBoundingSphere()}))(this.select(this.instance$,this.select(n=>n.heights)))})})}}return e.\u0275fac=function(){let i;return function(o){return(i||(i=t.n5z(e)))(o||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field-geometry","elementSize","","heights",""]],inputs:{elementSize:"elementSize",heights:"heights"},features:[t._Bn([(0,g.O2)(e)]),t.qOj],attrs:I,ngContentSelectors:T,decls:1,vars:0,template:function(n,o){1&n&&(t.F$t(),t.Hsn(0))},encapsulation:2,changeDetection:0}),e})();const U=["elementSize","","heights","","position","","rotation",""];let $=(()=>{class e{constructor(n){this.physicBody=n,this.elementSize=0,this.heights=[],this.position=[0,0,0],this.rotation=[0,0,0],this.color=F[17][4],this.heightFieldRef=this.physicBody.useHeightfield(()=>({args:[this.heights,{elementSize:this.elementSize}],position:this.position,rotation:this.rotation}))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.CN))},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field","elementSize","","heights","","position","","rotation",""]],inputs:{elementSize:"elementSize",heights:"heights",position:"position",rotation:"rotation"},features:[t._Bn([d.CN])],attrs:U,decls:3,vars:4,consts:[["castShadow","","receiveShadow","",3,"ref"],[3,"color"],[3,"elementSize","heights"]],template:function(n,o){1&n&&(t.TgZ(0,"ngt-mesh",0),t._UZ(1,"ngt-mesh-phong-material",1)(2,"sandbox-height-field-geometry",2),t.qZA()),2&n&&(t.Q6J("ref",o.heightFieldRef.ref),t.xp6(1),t.Q6J("color",o.color),t.xp6(1),t.Q6J("elementSize",o.elementSize)("heights",o.heights))},directives:[V.o,z.l,O],encapsulation:2,changeDetection:0}),e})();var j=s(1644),L=s(4986),R=s(948);const G=["columns","","rows","","spread",""],N=function(){return[.2,16,16]},P=function(){return["attributes","color"]},X=function(e){return[e,3]};function K(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"ngt-instanced-mesh",1)(2,"ngt-sphere-geometry",2),t._UZ(3,"ngt-instanced-buffer-attribute",3),t.qZA(),t._UZ(4,"ngt-mesh-phong-material",4),t.qZA(),t.BQk()),2&e){const n=i.ngIf,o=t.oxw();t.xp6(1),t.Q6J("count",n.number)("ref",o.sphereRef.ref),t.xp6(1),t.Q6J("args",t.DdM(5,N)),t.xp6(1),t.Q6J("attach",t.DdM(6,P))("args",t.VKq(7,X,n.colors))}}let Y=(()=>{class e extends g.gU{constructor(n){super(),this.physicBody=n,this.spread=0,this.sphereRef=this.physicBody.useSphere(o=>({args:[.2],mass:1,position:[(o%this.get(h=>h.columns)-(this.get(h=>h.columns)-1)/2)*this.spread,2,(Math.floor(o/this.get(h=>h.columns))-(this.get(h=>h.rows)-1)/2)*this.spread]})),this.viewModel$=this.select(this.select(o=>o.columns),this.select(o=>o.rows),(o,h)=>{const p=o*h,c=new Float32Array(3*p),a=new H.Ilk;for(let r=0;r<p;r++)a.set(F[17][Math.floor(5*Math.random())]).convertSRGBToLinear().toArray(c,3*r);return{colors:c,number:p}})}set columns(n){this.set({columns:(0,g.su)(n)})}set rows(n){this.set({rows:(0,g.su)(n)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.CN))},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-spheres","columns","","rows","","spread",""]],inputs:{columns:"columns",rows:"rows",spread:"spread"},features:[t._Bn([d.CN]),t.qOj],attrs:G,decls:2,vars:3,consts:[[4,"ngIf"],["castShadow","","receiveShadow","",3,"count","ref"],[3,"args"],[3,"attach","args"],["vertexColors",""]],template:function(n,o){1&n&&(t.YNc(0,K,5,9,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.viewModel$))},directives:[f.O5,j.f,L.o,R.a,z.l],pipes:[f.Ov],encapsulation:2,changeDetection:0}),e})();var b=s(4349),W=s(7298),w=s(8220),q=s(1188),k=s(132),_=s(54),tt=s(8407),et=s(9461);const nt=function(e){return[0,e,10]},st=function(e){return{position:e}},ot=function(){return[0,3,0]},it=function(e,i){return[e,0,i]},at=function(e){return[e,0,0]};let Z=(()=>{class e{constructor(){this.scale=10,this.heights=function rt({width:e,height:i,number:n,scale:o}){const h=[],p=[];for(let a=0;a<n;a++)p.push([Math.random(),Math.random()]);let c=0;for(let a=0;a<e;a++){const r=[];for(let m=0;m<i;m++){let l=1/0;p.forEach(M=>{const A=(M[0]-a/e)**2+(M[1]-m/i)**2;A<l&&(l=A)});const v=Math.sqrt(l);v>c&&(c=v),r.push(v)}h.push(r)}for(let a=0;a<e;a++)for(let r=0;r<i;r++)h[a][r]*=o/c;return h}({height:128,number:10,scale:1,width:128})}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["sandbox-height-field-example"]],inputs:{scale:"scale"},decls:12,vars:25,consts:[["shadows","",3,"camera"],["attach","background","color","#171720"],["enableDamping","","dampingFactor","0.2",3,"minPolarAngle","maxPolarAngle"],["intensity","0.5"],["castShadow","",3,"position"],[3,"elementSize","heights","position","rotation"],["rows","3","columns","3",3,"spread"]],template:function(n,o){1&n&&(t.TgZ(0,"ngt-canvas",0),t._UZ(1,"ngt-color",1)(2,"ngt-soba-orbit-controls",2),t.ALo(3,"radian"),t.ALo(4,"radian"),t.TgZ(5,"ngt-physics"),t._UZ(6,"ngt-ambient-light",3)(7,"ngt-directional-light",4)(8,"sandbox-height-field",5),t.ALo(9,"radian"),t._UZ(10,"sandbox-spheres",6),t.qZA(),t._UZ(11,"ngt-stats"),t.qZA()),2&n&&(t.Q6J("camera",t.VKq(17,st,t.VKq(15,nt,-10))),t.xp6(2),t.Q6J("minPolarAngle",t.lcZ(3,9,60))("maxPolarAngle",t.lcZ(4,11,60)),t.xp6(5),t.Q6J("position",t.DdM(19,ot)),t.xp6(1),t.Q6J("elementSize",o.scale/128)("heights",o.heights)("position",t.WLB(20,it,-o.scale/2,o.scale/2))("rotation",t.VKq(23,at,t.lcZ(9,13,-90))),t.xp6(2),t.Q6J("spread",4))},directives:function(){return[b.B3,W.r,w.S,q.r,k.w,_.Y,$,Y,tt.Q]},pipes:function(){return[et.j]},encapsulation:2,changeDetection:0}),e})(),ht=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.ez,E.Bz.forChild([{path:"",component:Z}]),Q.x,u.II,C.M$,B.Bg,C.R,u.fV,y.$5,g.DX,y.bg,J.Li,g.kZ,d.M1,S.EQ,S.in]]}),e})()}}]);